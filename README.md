# タイピングの入力チェックモジュール

## 仕様

[module]  
language       : C  
Character Code : UTF-8  
Line ending    : LF  

[sample]  
language       : C  
Character Code : UTF-8  
Line ending    : LF  
Environment    : Debian 7.5 (64bit)  

## 構成

サンプルファイル
* Makefile
* intext.txt
* sample.c


主要ファイル
* typingDiff.c
* typingDiff.h
* wordlist


その他
* README.md

## 使用にあたって

モジュールとして動作に必要なファイルは上記「主要ファイル」のみです。

報告や記載等特に必要ありません。自由に利用、改変して頂いて結構です。

但し著作権はhayato4814(ハヤト)に帰属します。

## 概要

日本語のタイピングソフト用に、日本語をローマ字に変換した際の入力正否を判定するモジュールです。

例えば「ん」は"n"とも"nn"打つことができますが、

「んな」のように「ん」の次に「な行」があると"nnna"のように「ん」は"nn"と打たなければいけません。

他にも「ちゃ」は"tya"や"cha"、"tilya"、"chixya"・・・のように複数パターンで変換できます。

このモジュールは平仮名の文字列とローマ字の文字列を比較し、ローマ字の文字列が何文字目まで合っているかを判定してくれるモジュールです。
また平仮名を最後までローマ字に変換した結果も同時に取得されます。

例えば平仮名「こころぴょんぴょんまち？かんがえるふりしてもうちょっとちかづいちゃえ」、  

入力ローマ字"kokoropyonnpyonnmachi?ku"と入力したとすると、

正しい文字数23文字("kokoropyonnpyonnmachi?k"までの文字数)が返されます。

また"kokoropyonnpyonnmachi?kanngaerufurisitemoutyottochikaduityae"と完全にローマ字にした場合の文字列が返されます。

ここで「ち」は"ti"とも"chi"とも入力できますが、これは最後に入力された変換パターンが用いられます。(1文中に「ち」が複数出てきた場合に"ti"、"chi"の両方を交互に用いても正しく判定されます)

このモジュールは、**先頭から何文字目まで一致しているか**のみを判定するため、タイピングの正否などは自分で判断する必要があります。
(キー入力されたのに正しい文字数が変化していない、入力文字列の文字数と正しい文字数が一致しない等)

## 使い方

当モジュールを使用したいc言語で

`#include "typingDiff.h"`

もしくはc++言語で

`
extern "C"{
    #include "typingDiff.h"  
}
`

の様にincludeしてください。

モジュールの使い方については以下、関数仕様に記します。

## 関数仕様

int typingDiffInit(void);  
戻り値： 0(正常) / 0以外(異常)  
引数： なし  

処理：  
モジュールを初期化します。必ず最初に1回行ってください。また終了処理を行わず連続で呼び出さないでください。
正常に初期化できた場合 0 を、初期化に失敗した場合 1 を返します。

***

int typingDiffFinal(void);  
戻り値： 0(正常)
引数： なし

処理:  
モジュールの終了処理を行います。モジュールの初期化を行っていた場合必ず呼び出してください。
戻り値は0(正常終了)のみです。

***

int getTypingDiff(char* kana, char* typed,char* fullstr);  
戻り値：-1(完全一致) 0以上(文字数)  
引数：  
> char* kana  

タイピングの入力すべきキーワードを2byte文字平仮名で渡してください。

> char* typed  

タイピングの、ユーザーがタイプした文字列(現在のキーワードの先頭から全て)を渡してください。

> char* fullstr  

ユーザーがタイプした文字列を基準に、タイピングの入力すべきキーワード(平仮名)を全てローマ字に変換した場合の文字列が代入されます。  
受け取る変数サイズは TYPINGDIFF_STRLENGTH までとしてください。

処理:  
タイピングの入力すべきキーワード(平仮名)をローマ字にした場合、ユーザーがタイプした文字列の何文字目まで合っているかを判定し、その結果文字数を返します。最後まで完全に一致している場合は―1を返します。

***

## サンプルコード

sample.c の内容です。動作環境はDebian7となります。
